From 8963d8e7f25c20867d3aef89ed9aa9c60c940841 Mon Sep 17 00:00:00 2001
From: Pierrick Bouvier <pierrick.bouvier@linaro.org>
Date: Mon, 23 Feb 2026 10:19:40 -0800
Subject: [PATCH] feat(qemu): Add stubs to support IDE key management

From: Mathieu Poirier <mathieu.poirier@linaro.org>
Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org>
---
 plat/qemu/qemu_sbsa/platform.mk        |  8 +++++
 plat/qemu/qemu_sbsa/sbsa_ide_keymgmt.c | 48 ++++++++++++++++++++++++++
 2 files changed, 56 insertions(+)
 create mode 100644 plat/qemu/qemu_sbsa/sbsa_ide_keymgmt.c

diff --git a/plat/qemu/qemu_sbsa/platform.mk b/plat/qemu/qemu_sbsa/platform.mk
index a1aeca3..abf0105 100644
--- a/plat/qemu/qemu_sbsa/platform.mk
+++ b/plat/qemu/qemu_sbsa/platform.mk
@@ -20,6 +20,10 @@ NEED_BL32		:=	yes
 EL3_EXCEPTION_HANDLING	:=	1
 endif
 
+ifeq (${ENABLE_RME},1)
+    RMMD_ENABLE_IDE_KEY_PROG   := 1
+endif
+
 include plat/qemu/common/common.mk
 
 # Enable new version of image loading on QEMU platforms
@@ -62,6 +66,10 @@ ifeq (${SPM_MM},1)
 	BL31_SOURCES		+=	${PLAT_QEMU_COMMON_PATH}/qemu_spm.c
 endif
 
+ifeq (${ENABLE_RME},1)
+       BL31_SOURCES            +=      ${PLAT_QEMU_PATH}/sbsa_ide_keymgmt.c
+endif
+
 ifeq (${SPD},spmd)
 BL31_SOURCES		+=	plat/common/plat_spmd_manifest.c	\
 				common/uuid.c				\
diff --git a/plat/qemu/qemu_sbsa/sbsa_ide_keymgmt.c b/plat/qemu/qemu_sbsa/sbsa_ide_keymgmt.c
new file mode 100644
index 0000000..ff05351
--- /dev/null
+++ b/plat/qemu/qemu_sbsa/sbsa_ide_keymgmt.c
@@ -0,0 +1,48 @@
+/*
+ * Copyright (c) 2025, Arm Limited and Contributors. All rights reserved.
+ *
+ * SPDX-License-Identifier: BSD-3-Clause
+ */
+
+#include <errno.h>
+#include <string.h>
+
+#include <plat/common/platform.h>
+
+int plat_rmmd_el3_ide_key_program(uint64_t ecam_address, uint64_t root_port_id,
+				  uint64_t ide_stream_info,
+				  rp_ide_key_info_t *ide_key_info_ptr, uint64_t request_id,
+				  uint64_t cookie)
+{
+	/* placeholder to add further implementation */
+
+	return 0;
+
+}
+
+int plat_rmmd_el3_ide_key_set_go(uint64_t ecam_address, uint64_t root_port_id,
+				 uint64_t ide_stream_info, uint64_t request_id,
+				 uint64_t cookie)
+{
+	/* placeholder to add further implementation */
+
+	return 0;
+
+}
+
+int plat_rmmd_el3_ide_key_set_stop(uint64_t ecam_address, uint64_t root_port_id,
+				   uint64_t ide_stream_info, uint64_t request_id,
+				   uint64_t cookie)
+{
+	/* placeholder to add further implementation */
+
+	return 0;
+}
+
+int plat_rmmd_el3_ide_km_pull_response(uint64_t ecam_address, uint64_t root_port_id,
+				   uint64_t *req_resp, uint64_t *request,
+				   uint64_t *cookie)
+{
+	/* placeholder to add further implementation */
+	return E_RMM_UNK;
+}
-- 
2.47.3

